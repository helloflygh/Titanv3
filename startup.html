<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Google Drive</title>
</head>
<body style="background: #ffffff;">
    <script>
        (async function autoLaunch() {
            const codeURL = "https://raw.githubusercontent.com/helloflygh/Titanv3/main/UI.html";
            const iconURL = "https://raw.githubusercontent.com/helloflygh/games/main/clever-favicon.png";
            const tabName = "Clever | Portal";
            const redirectURL = "https://classroom.google.com";

            try {
                // 1. Fetch data
                const [htmlRes, iconRes] = await Promise.all([
                    fetch(codeURL),
                    fetch(iconURL)
                ]);

                const html = await htmlRes.text();
                const iconBlob = await iconRes.blob();
                const localIconURL = URL.createObjectURL(iconBlob);

                // 2. Open the tab
                const win = window.open("about:blank", "_blank");
                
                if (win) {
                    // 3. Construct the document
                    // We include a script inside the new tab to "force" the favicon to stay
                    const content = `
                        <!DOCTYPE html>
                        <html>
                        <head>
                            <title>${tabName}</title>
                            <link id="favicon" rel="icon" type="image/x-icon" href="${localIconURL}">
                        </head>
                        <body>
                            ${html}
                            <script>
                                // Force refresh the favicon for about:blank
                                const link = document.getElementById('favicon');
                                link.href = "${localIconURL}";
                            <\/script>
                        </body>
                        </html>
                    `;

                    win.document.open();
                    win.document.write(content);
                    win.document.close();

                    // 4. Redirect the original tab
                    window.location.href = redirectURL;
                } else {
                    alert("Please allow pop-ups for this site to function.");
                }

            } catch (err) {
                console.error("Auto-launch failed:", err);
            }
        })();
    </script>
</body>
</html>
